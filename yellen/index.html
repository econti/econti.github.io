<!DOCTYPE html>
<html>
<head>
<head>
<script src='https://platform.venmo.com/sdk.js'></script>
</head>
<link rel="shortcut icon" href="fav.png" />
<title>YELLEN OUT EA$T</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
<meta name="description" content="Yellen out east.">
<style>
.btn-xlarge {
    padding: 18px 28px;
    font-size: 22px; //change this to your desired size
    line-height: normal;
    -webkit-border-radius: 8px;
       -moz-border-radius: 8px;
            border-radius: 8px;
}
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45819348-1', 'yourdirtymouth.com');
  ga('send', 'pageview');

</script>

</head>
<body style="background-image: url('yellen2.png');">
  <div style="max-width:800px; padding-top:30px;margin: 0 auto;padding-left:20px;padding-right:20px;">
    <div class="row">
        <div style="margin-bottom:15px" class="fb-like" data-href="https://www.facebook.com/yellenouteast" data-layout="button" data-action="like" data-show-faces="true" data-share="true"></div>
      <div style="margin-bottom:5px;"><a href="https://twitter.com/share" class="twitter-share-button" data-url="http://www.yellenouteast.com" data-text="Do you even go out east?" data-via="YellenOutEast" data-hashtags="yellenouteast">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></div>
      <div style="">
        <a class="venmo-pay-button" data-recipient-id="1010942070489088211"></a>
      </div>
  </div> 
  <div class="row">
    <div ><h1 style="font-size:70px;">YELLEN OUT EA$T</h1></div>
<!--     <img style="height:130px;margin-bottom:40px;float:right;" src="yellen.png"> -->
    <a id="login" class='btn btn-success btn-xlarge' style="display:none;margin-right:10px">Do you even go out east?</a>
    <br><br>
    contact us at yellenouteast@gmail.com | <a href="privacy.html" target="_blank">privacy policy</a>
    <div id="loader">
    </div>
    <div id='shitList' style="padding-top:20px;">
      <div id='clean'>
      </div>
      <ol id="shitlist-list">
      </ol>
    </div>
  </div>
  <div id="fb-root"></div>
  </div> 

</body>

<script>
var messages;
var words;
var counts;
var userID;

var phrases = {
"my 3br apt": 1,
"east hampton":1,
"free money":1,
"hamptons jitney":1,
"helicopter money":1,
"indian wells":1,
"indian wells beach":1,
"martha's vineyard":1,
"memory motel":1,
"models and bottles":1,
"polo match":1,
"raining champagne":1,
"sag harbor":1,
"shelter island":1,
"stephen talkhouse":1,
"surf lodge":1,
"the cape":1,
"the point":1,
"the vineyard":1,
"private equity":1,
"hedge fund":1,
"investment management":1,
"hampton bays":1,
"make it rain":1,
"private jet":1,
"investment banking":1,
"long island":1
}

var scores = {
"amagansett":1,
"blade":1,
"bottles":1,
"cyril's":1,
"ferrari":1,
"hamptons":1,
"helicopter":1,
"mansion":1,
"models":1,
"mashomack":1,
"nantucket":1,
"montaulk":1,
"porshe":1,
"ruschmeyers":1,
"ruschmeyer's":1,
"talkhouse":1,
"yacht":1,
"yellen":1,
"polo":1,
"hampton":1,
"jitney":1,
"vineyard":1,
"models":1,
"bottles":1,
"harbor":1,
"island":1,
"talkhouse":1,
"banking":1,
"investor":1,
"banker":1,
"consultant":1,
"cocaine":1,
"westhampton":1,
"southampton":1,
"wainscott":1,
"cidiot":1,
"hampster":1,
"bottom-feeder":1,
"mcmansion":1,
"mansion":1,
"sagaponack":1,
"cidiots":1,
"touron":1,
"tourons":1,
"benz":1,
"goldman":1,
"sachs":1
};

window.fbAsyncInit = function() {
  //prod: 1420062641557251
  //dev: 501949316569863
  // init the FB JS SDK
  FB.init({
    appId      : '276486392557915',                        // App ID from the app dashboard
    channelUrl : 'http://localhost/yellen/', // Channel file for x-domain comms
    status     : true,                                 // Check Facebook Login status
    xfbml      : true,                                 // Look for social plugins on the page
    cookie      :true
  });

  $("#login").show();
};
//herpy derp
// Load the SDK asynchronously
$("#login").click(function(){
  login();
});

$("#logout").click(function(){
  
  FB.logout(function(response) {
    $("#shitlist-list").html($("<h3>").html("This never happened."));
  });
  
});

(function(d, s, id){
   var js, fjs = d.getElementsByTagName(s)[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement(s); js.id = id;
   js.src = "https://connect.facebook.net/en_US/all.js";
   fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));
  
function getData(d) {
    var b = 100;
    var a = 20;
    for (var c = 0; c < a; c++) {
        needLoadCount++;
        FB.api(d + "&limit=" + b + "&offset=" + b * c, function (f) {
            doneLoadCount++;
            if (doneLoadCount == needLoadCount) {
                finishedLoading();
            }
            if (f.error) {
                console.log(d, f.error.message);
                return
            }
            if (!f || !f.data || !f.data.length) {
                return
            }
            var i = f.data;
            for (j = 0; j < i.length; j++) {
                var g = i[j];
                if(g.from) {
                  isPhoto = true;
                }
                if (!g.from || g.from.id == userID) {
                    var h = g.message;
                    if (!h) {
                        h = g.name
                    }
                    var isPhoto = false;
                    if (h) {
                        // var tokens = g.id.split("_");
                        // var id = tokens[tokens.length - 1]; 
                        addMessage([h, g.id, isPhoto])
                    }
                }
                var l = g.comments;
                if (!l || !l.data || !l.data.length) {
                    continue
                }
                for (var e = 0; e < l.data.length; e++) {
                    var m = l.data[e];
                    if (m.from && m.from.id == userID && m.message) {
                        // var tokens = m.id.split("_");
                        // var id = tokens[tokens.length - 1]; 
                        addMessage([m.message, m.id, isPhoto])
                    }
                }
            }
        })
    }
}

function finishedLoading() {
  stopLoading();
  counts = vulgarCount(messages);
  
  if (counts.length == 0) {
    $("#clean").html("<h2>Take it easy hampster, you don't go out east.</h2><a id='share' class='btn btn-large btn-info' onclick=\"share('I am just a hampster, how about you?')\">Share</a>");

  }

  for (var i=0; i<500; i++) {
    if (!counts[i] || counts[i][1] == 0) break;
    $("#shitlist-list").append("<li class='panel panel-default' style='font-size:20px;padding:10px;'>" + counts[i][0].replace(/"/g,"").replace(/\"/g,"") + "<br><br><a id='share' class='btn btn-large btn-info' onclick=\"share('" + counts[i][0].replace(/"/g,"").replace(/\"/g,"").replace(/'/g,"\\'").replace(/\n/g," ") + "');\">Share</a><br><br><a class='btn btn-large btn-danger' target=\"_blank\" href=\"https://www.facebook.com/" + (counts[i][3] ? "photo.php?fbid=" + counts[i][2] : userID + "/posts/" + split(counts[i][2]) )+ "\">Go to post</a></li>");
  }

  $("#share").show();
}

function vulgarCount(messageArray) {
  var offensive = [];
  for (var n in messageArray){
    var vulgarity = 0;
    for (var key in phrases) {
      m = messageArray[n][0].match(new RegExp(key,"gi"));
      if (m) vulgarity += m.length * scores[key];   
    }
    var ws = messageArray[n][0].split(" ");
    for (var i in ws) {
      var w = ws[i].toLowerCase().replace(/[^a-z]/g,"");
      vulgarity += scores[w] || 0;      
    }
    if (vulgarity > 0) offensive.push([messageArray[n][0].toString(), vulgarity, messageArray[n][1], messageArray[n][2]]);
  }
  return offensive.sort(function(a,b) {
    return b[1]-a[1];
  });
}

function addMessage(a) {
  if (messages.length > 1000) {
      return
  }
  messages.push(a);
}
  

function resetData() {
  messages = [];
  needLoadCount = 0;
  doneLoadCount = 0;
  startLoading()
}


function loadData() {
  resetData();
  getData("/me/posts?fields=message,comments.fields(from,message)");
  getData("/me/feed?fields=from,message,comments.fields(from,message)");
  getData("/me/statuses?fields=message,comments.fields(from,message)");
  getData("/me/links?fields=message,comments.fields(from,message)");
  getData("/me/checkins?fields=message,comments.fields(from,message)");
  getData("/me/photos?fields=from,name,comments.fields(from,message)")
}

function login() {
  FB.login(function (a) {
    if (a && a.status == "connected") {
      userID = a.authResponse.userID;
      loadData();
    }
  }, {
    scope: "user_status,user_photos"
  });
  $("#shitlist-list").html($("<h3>").html(""));
}

function stopLoading() {
  $("#loader").html("");
}

function startLoading() {
  $("#loader").html("<img src='http://www.mytreedb.com/uploads/mytreedb/loader/ajax_loader_gray_350.gif' style=height:200px;margin-top:50px;>");
}

function split(str) {
 var i = str.indexOf("_");

 if(str.indexOf('_') != -1)
  return  str.slice(0, i);
 else
  return str;     
}

 var share = function(shitToShare) {
  FB.ui({
      method: "feed",
      display: "iframe",
      link: "http://www.google.com",
      caption: "How out east are you?",
      description: shitToShare,
      picture: "https://d3j5vwomefv46c.cloudfront.net/photos/large/809296425.jpg?1379376478"
  });
};


</script>
</html>